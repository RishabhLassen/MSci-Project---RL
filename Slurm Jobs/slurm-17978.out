Running on  compute-gpu-0-1.local
Moved dir, now in:
/home/xzcaplas/PHAS0097_RLASSEN/salt

CUDA_VISIBLE_DEVICES:
0,1,2
CUDA_VISIBLE_DEVICES:
0,1,2
Tue Mar 12 10:41:20 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.08              Driver Version: 545.23.08    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          Off | 00000000:17:00.0 Off |                    0 |
| N/A   28C    P0              42W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          Off | 00000000:65:00.0 Off |                    0 |
| N/A   27C    P0              41W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          Off | 00000000:CA:00.0 Off |                    0 |
| N/A   26C    P0              42W / 300W |      2MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Ntasks

Obtaining file:///home/xzcaplas/PHAS0097_RLASSEN/salt
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Installing backend dependencies: started
  Installing backend dependencies: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: pytest==7.2.2 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (7.2.2)
Requirement already satisfied: pytest-cov==4.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (4.0.0)
Requirement already satisfied: h5py==3.8.0 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (3.8.0)
Requirement already satisfied: numpy==1.24.2 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (1.24.2)
Requirement already satisfied: torch==2.0.1 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (2.0.1)
Requirement already satisfied: lightning==2.0.2 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (2.0.2)
Requirement already satisfied: jsonargparse==4.19.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (4.19.0)
Requirement already satisfied: torchmetrics==0.11.4 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (0.11.4)
Requirement already satisfied: comet-ml==3.33.5 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (3.33.5)
Requirement already satisfied: tqdm==4.65.0 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (4.65.0)
Requirement already satisfied: rich==13.4.2 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (13.4.2)
Requirement already satisfied: pre-commit==3.2.1 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (3.2.1)
Requirement already satisfied: onnx==1.13.0 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (1.13.0)
Requirement already satisfied: onnxruntime==1.13.1 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (1.13.1)
Requirement already satisfied: atlas-ftag-tools==0.1.11 in ./conda/envs/salt/lib/python3.10/site-packages (from salt==0.3) (0.1.11)
Requirement already satisfied: PyYAML>=5.1 in ./conda/envs/salt/lib/python3.10/site-packages (from atlas-ftag-tools==0.1.11->salt==0.3) (6.0.1)
Requirement already satisfied: jsonschema!=3.1.0,>=2.6.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (4.19.2)
Requirement already satisfied: psutil>=5.6.3 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (5.9.6)
Requirement already satisfied: python-box<7.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (6.1.0)
Requirement already satisfied: requests-toolbelt>=0.8.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (1.0.0)
Requirement already satisfied: requests>=2.18.4 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (2.31.0)
Requirement already satisfied: semantic-version>=2.8.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (2.10.0)
Requirement already satisfied: sentry-sdk>=1.1.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (1.35.0)
Requirement already satisfied: simplejson in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (3.19.2)
Requirement already satisfied: six in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (1.16.0)
Requirement already satisfied: urllib3>=1.21.1 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (2.0.7)
Requirement already satisfied: websocket-client<1.4.0,>=0.55.0 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (1.3.3)
Requirement already satisfied: wrapt>=1.11.2 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (1.16.0)
Requirement already satisfied: wurlitzer>=1.0.2 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (3.0.3)
Requirement already satisfied: everett<3.2.0,>=1.0.1 in ./conda/envs/salt/lib/python3.10/site-packages (from everett[ini]<3.2.0,>=1.0.1; python_version > "3.5"->comet-ml==3.33.5->salt==0.3) (3.1.0)
Requirement already satisfied: dulwich!=0.20.33,>=0.20.6 in ./conda/envs/salt/lib/python3.10/site-packages (from comet-ml==3.33.5->salt==0.3) (0.21.6)
Requirement already satisfied: docstring-parser>=0.15 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (0.15)
Requirement already satisfied: typeshed-client>=2.1.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (2.4.0)
Requirement already satisfied: fsspec>=0.8.4 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (2023.10.0)
Requirement already satisfied: argcomplete>=2.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (3.1.6)
Requirement already satisfied: ruyaml>=0.20.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (0.91.0)
Requirement already satisfied: omegaconf>=2.1.1 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (2.3.0)
Requirement already satisfied: reconplogger>=4.4.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (4.12.0)
Requirement already satisfied: jsonnet>=0.13.0 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonargparse[all]==4.19.0->salt==0.3) (0.17.0)
Requirement already satisfied: Jinja2<5.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (3.1.2)
Requirement already satisfied: arrow<3.0,>=1.2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (1.3.0)
Requirement already satisfied: beautifulsoup4<6.0,>=4.8.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (4.12.2)
Requirement already satisfied: click<10.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (8.1.7)
Requirement already satisfied: croniter<1.4.0,>=1.3.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (1.3.15)
Requirement already satisfied: dateutils<2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.6.12)
Requirement already satisfied: deepdiff<8.0,>=5.7.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (6.7.1)
Requirement already satisfied: fastapi<0.89.0,>=0.69.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.88.0)
Requirement already satisfied: inquirer<5.0,>=2.10.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (3.1.3)
Requirement already satisfied: lightning-cloud>=0.5.34 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.5.54)
Requirement already satisfied: lightning-utilities<2.0,>=0.7.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.9.0)
Requirement already satisfied: packaging in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (23.2)
Requirement already satisfied: pydantic<4.0,>=1.7.4 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (1.10.13)
Requirement already satisfied: starlette in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.22.0)
Requirement already satisfied: starsessions<2.0,>=1.2.1 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (1.3.0)
Requirement already satisfied: traitlets<7.0,>=5.3.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (5.13.0)
Requirement already satisfied: typing-extensions<6.0,>=4.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (4.8.0)
Requirement already satisfied: uvicorn<2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (0.24.0.post1)
Requirement already satisfied: websockets<12.0 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (11.0.3)
Requirement already satisfied: pytorch-lightning in ./conda/envs/salt/lib/python3.10/site-packages (from lightning==2.0.2->salt==0.3) (2.1.2)
Requirement already satisfied: protobuf<4,>=3.20.2 in ./conda/envs/salt/lib/python3.10/site-packages (from onnx==1.13.0->salt==0.3) (3.20.3)
Requirement already satisfied: coloredlogs in ./conda/envs/salt/lib/python3.10/site-packages (from onnxruntime==1.13.1->salt==0.3) (15.0.1)
Requirement already satisfied: flatbuffers in ./conda/envs/salt/lib/python3.10/site-packages (from onnxruntime==1.13.1->salt==0.3) (23.5.26)
Requirement already satisfied: sympy in ./conda/envs/salt/lib/python3.10/site-packages (from onnxruntime==1.13.1->salt==0.3) (1.12)
Requirement already satisfied: cfgv>=2.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from pre-commit==3.2.1->salt==0.3) (3.4.0)
Requirement already satisfied: identify>=1.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from pre-commit==3.2.1->salt==0.3) (2.5.31)
Requirement already satisfied: nodeenv>=0.11.1 in ./conda/envs/salt/lib/python3.10/site-packages (from pre-commit==3.2.1->salt==0.3) (1.8.0)
Requirement already satisfied: virtualenv>=20.10.0 in ./conda/envs/salt/lib/python3.10/site-packages (from pre-commit==3.2.1->salt==0.3) (20.24.6)
Requirement already satisfied: attrs>=19.2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from pytest==7.2.2->salt==0.3) (23.1.0)
Requirement already satisfied: iniconfig in ./conda/envs/salt/lib/python3.10/site-packages (from pytest==7.2.2->salt==0.3) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in ./conda/envs/salt/lib/python3.10/site-packages (from pytest==7.2.2->salt==0.3) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in ./conda/envs/salt/lib/python3.10/site-packages (from pytest==7.2.2->salt==0.3) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from pytest==7.2.2->salt==0.3) (2.0.1)
Requirement already satisfied: coverage>=5.2.1 in ./conda/envs/salt/lib/python3.10/site-packages (from coverage[toml]>=5.2.1->pytest-cov==4.0.0->salt==0.3) (7.3.2)
Requirement already satisfied: markdown-it-py>=2.2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from rich==13.4.2->salt==0.3) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in ./conda/envs/salt/lib/python3.10/site-packages (from rich==13.4.2->salt==0.3) (2.16.1)
Requirement already satisfied: filelock in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (3.13.1)
Requirement already satisfied: networkx in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (3.2.1)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.7.99)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.7.99)
Requirement already satisfied: nvidia-cuda-cupti-cu11==11.7.101 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.7.101)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.10.3.66)
Requirement already satisfied: nvidia-cufft-cu11==10.9.0.58 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (10.9.0.58)
Requirement already satisfied: nvidia-curand-cu11==10.2.10.91 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (10.2.10.91)
Requirement already satisfied: nvidia-cusolver-cu11==11.4.0.1 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.4.0.1)
Requirement already satisfied: nvidia-cusparse-cu11==11.7.4.91 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.7.4.91)
Requirement already satisfied: nvidia-nccl-cu11==2.14.3 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (2.14.3)
Requirement already satisfied: nvidia-nvtx-cu11==11.7.91 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (11.7.91)
Requirement already satisfied: triton==2.0.0 in ./conda/envs/salt/lib/python3.10/site-packages (from torch==2.0.1->salt==0.3) (2.0.0)
Requirement already satisfied: setuptools in ./conda/envs/salt/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch==2.0.1->salt==0.3) (68.2.2)
Requirement already satisfied: wheel in ./conda/envs/salt/lib/python3.10/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch==2.0.1->salt==0.3) (0.41.3)
Requirement already satisfied: cmake in ./conda/envs/salt/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->salt==0.3) (3.27.7)
Requirement already satisfied: lit in ./conda/envs/salt/lib/python3.10/site-packages (from triton==2.0.0->torch==2.0.1->salt==0.3) (17.0.5)
Requirement already satisfied: python-dateutil>=2.7.0 in ./conda/envs/salt/lib/python3.10/site-packages (from arrow<3.0,>=1.2.0->lightning==2.0.2->salt==0.3) (2.8.2)
Requirement already satisfied: types-python-dateutil>=2.8.10 in ./conda/envs/salt/lib/python3.10/site-packages (from arrow<3.0,>=1.2.0->lightning==2.0.2->salt==0.3) (2.8.19.14)
Requirement already satisfied: soupsieve>1.2 in ./conda/envs/salt/lib/python3.10/site-packages (from beautifulsoup4<6.0,>=4.8.0->lightning==2.0.2->salt==0.3) (2.5)
Requirement already satisfied: pytz in ./conda/envs/salt/lib/python3.10/site-packages (from dateutils<2.0->lightning==2.0.2->salt==0.3) (2023.3.post1)
Requirement already satisfied: ordered-set<4.2.0,>=4.0.2 in ./conda/envs/salt/lib/python3.10/site-packages (from deepdiff<8.0,>=5.7.0->lightning==2.0.2->salt==0.3) (4.1.0)
Requirement already satisfied: configobj in ./conda/envs/salt/lib/python3.10/site-packages (from everett[ini]<3.2.0,>=1.0.1; python_version > "3.5"->comet-ml==3.33.5->salt==0.3) (5.0.8)
Requirement already satisfied: anyio<5,>=3.4.0 in ./conda/envs/salt/lib/python3.10/site-packages (from starlette->lightning==2.0.2->salt==0.3) (4.0.0)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in ./conda/envs/salt/lib/python3.10/site-packages (from fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (3.8.6)
Requirement already satisfied: blessed>=1.19.0 in ./conda/envs/salt/lib/python3.10/site-packages (from inquirer<5.0,>=2.10.0->lightning==2.0.2->salt==0.3) (1.20.0)
Requirement already satisfied: python-editor>=1.0.4 in ./conda/envs/salt/lib/python3.10/site-packages (from inquirer<5.0,>=2.10.0->lightning==2.0.2->salt==0.3) (1.0.4)
Requirement already satisfied: readchar>=3.0.6 in ./conda/envs/salt/lib/python3.10/site-packages (from inquirer<5.0,>=2.10.0->lightning==2.0.2->salt==0.3) (4.0.5)
Requirement already satisfied: MarkupSafe>=2.0 in ./conda/envs/salt/lib/python3.10/site-packages (from Jinja2<5.0->lightning==2.0.2->salt==0.3) (2.1.3)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet-ml==3.33.5->salt==0.3) (2023.11.1)
Requirement already satisfied: referencing>=0.28.4 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet-ml==3.33.5->salt==0.3) (0.31.0)
Requirement already satisfied: rpds-py>=0.7.1 in ./conda/envs/salt/lib/python3.10/site-packages (from jsonschema!=3.1.0,>=2.6.0->comet-ml==3.33.5->salt==0.3) (0.12.0)
Requirement already satisfied: pyjwt in ./conda/envs/salt/lib/python3.10/site-packages (from lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (2.8.0)
Requirement already satisfied: python-multipart in ./conda/envs/salt/lib/python3.10/site-packages (from lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (0.0.6)
Requirement already satisfied: boto3 in ./conda/envs/salt/lib/python3.10/site-packages (from lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (1.29.1)
Requirement already satisfied: mdurl~=0.1 in ./conda/envs/salt/lib/python3.10/site-packages (from markdown-it-py>=2.2.0->rich==13.4.2->salt==0.3) (0.1.2)
Requirement already satisfied: antlr4-python3-runtime==4.9.* in ./conda/envs/salt/lib/python3.10/site-packages (from omegaconf>=2.1.1->jsonargparse[all]==4.19.0->salt==0.3) (4.9.3)
Requirement already satisfied: logmatic-python>=0.1.7 in ./conda/envs/salt/lib/python3.10/site-packages (from reconplogger>=4.4.0->jsonargparse[all]==4.19.0->salt==0.3) (0.1.7)
Requirement already satisfied: charset-normalizer<4,>=2 in ./conda/envs/salt/lib/python3.10/site-packages (from requests>=2.18.4->comet-ml==3.33.5->salt==0.3) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in ./conda/envs/salt/lib/python3.10/site-packages (from requests>=2.18.4->comet-ml==3.33.5->salt==0.3) (3.4)
Requirement already satisfied: certifi>=2017.4.17 in ./conda/envs/salt/lib/python3.10/site-packages (from requests>=2.18.4->comet-ml==3.33.5->salt==0.3) (2023.7.22)
Requirement already satisfied: distro>=1.3.0 in ./conda/envs/salt/lib/python3.10/site-packages (from ruyaml>=0.20.0->jsonargparse[all]==4.19.0->salt==0.3) (1.8.0)
Requirement already satisfied: itsdangerous<3.0.0,>=2.0.1 in ./conda/envs/salt/lib/python3.10/site-packages (from starsessions<2.0,>=1.2.1->lightning==2.0.2->salt==0.3) (2.1.2)
Requirement already satisfied: importlib-resources>=1.4.0 in ./conda/envs/salt/lib/python3.10/site-packages (from typeshed-client>=2.1.0->jsonargparse[all]==4.19.0->salt==0.3) (6.1.1)
Requirement already satisfied: h11>=0.8 in ./conda/envs/salt/lib/python3.10/site-packages (from uvicorn<2.0->lightning==2.0.2->salt==0.3) (0.14.0)
Requirement already satisfied: distlib<1,>=0.3.7 in ./conda/envs/salt/lib/python3.10/site-packages (from virtualenv>=20.10.0->pre-commit==3.2.1->salt==0.3) (0.3.7)
Requirement already satisfied: platformdirs<4,>=3.9.1 in ./conda/envs/salt/lib/python3.10/site-packages (from virtualenv>=20.10.0->pre-commit==3.2.1->salt==0.3) (3.11.0)
Requirement already satisfied: humanfriendly>=9.1 in ./conda/envs/salt/lib/python3.10/site-packages (from coloredlogs->onnxruntime==1.13.1->salt==0.3) (10.0)
Requirement already satisfied: mpmath>=0.19 in ./conda/envs/salt/lib/python3.10/site-packages (from sympy->onnxruntime==1.13.1->salt==0.3) (1.3.0)
Requirement already satisfied: multidict<7.0,>=4.5 in ./conda/envs/salt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (6.0.4)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in ./conda/envs/salt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (4.0.3)
Requirement already satisfied: yarl<2.0,>=1.0 in ./conda/envs/salt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (1.9.2)
Requirement already satisfied: frozenlist>=1.1.1 in ./conda/envs/salt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (1.4.0)
Requirement already satisfied: aiosignal>=1.1.2 in ./conda/envs/salt/lib/python3.10/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]<2025.0,>2021.06.0->lightning==2.0.2->salt==0.3) (1.3.1)
Requirement already satisfied: sniffio>=1.1 in ./conda/envs/salt/lib/python3.10/site-packages (from anyio<5,>=3.4.0->starlette->lightning==2.0.2->salt==0.3) (1.3.0)
Requirement already satisfied: wcwidth>=0.1.4 in ./conda/envs/salt/lib/python3.10/site-packages (from blessed>=1.19.0->inquirer<5.0,>=2.10.0->lightning==2.0.2->salt==0.3) (0.2.10)
Requirement already satisfied: python-json-logger in ./conda/envs/salt/lib/python3.10/site-packages (from logmatic-python>=0.1.7->reconplogger>=4.4.0->jsonargparse[all]==4.19.0->salt==0.3) (2.0.7)
Requirement already satisfied: botocore<1.33.0,>=1.32.1 in ./conda/envs/salt/lib/python3.10/site-packages (from boto3->lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (1.32.1)
Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in ./conda/envs/salt/lib/python3.10/site-packages (from boto3->lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (1.0.1)
Requirement already satisfied: s3transfer<0.8.0,>=0.7.0 in ./conda/envs/salt/lib/python3.10/site-packages (from boto3->lightning-cloud>=0.5.34->lightning==2.0.2->salt==0.3) (0.7.0)
Building wheels for collected packages: salt
  Building editable for salt (pyproject.toml): started
  Building editable for salt (pyproject.toml): finished with status 'done'
  Created wheel for salt: filename=salt-0.3-0.editable-py3-none-any.whl size=2999 sha256=ee7f2278d7f6ad88876ad55cc4391b19b04157d22bfecfeab540ce559aa2bf76
  Stored in directory: /tmp/pip-ephem-wheel-cache-qsz1jaft/wheels/e5/6c/0e/e1256ec4cd88d4d07533d699bb4a3d5449ebb9d9019e9cb72c
Successfully built salt
Installing collected packages: salt
Successfully installed salt-0.3
Running training script...
Batchsize: 666
[rank: 0] Global seed set to 42
CometLogger will be initialized in online mode
/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/xzcaplas/PHAS0097_RLASSEN/salt/python_install/ ...
  rank_zero_warn(
Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'lightning.pytorch.callbacks.model_summary.ModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/xzcaplas/PHAS0097_RLASSEN/salt/python_install/ ...
  rank_zero_warn(
[rank: 0] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/3
[W socket.cpp:426] [c10d] The server socket cannot be initialized on [::]:51757 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
[rank: 2] Global seed set to 42
CometLogger will be initialized in online mode
[rank: 1] Global seed set to 42
CometLogger will be initialized in online mode
[rank: 2] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/3
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
[rank: 1] Global seed set to 42
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/3
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
[W socket.cpp:601] [c10d] The client socket cannot be initialized to connect to [localhost.localdomain]:51757 (errno: 97 - Address family not supported by protocol).
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 3 processes
----------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------
Created training dataset with 34,000,000 jets
Created validation dataset with 3,400,000 jets
---------------------------------------------------------------------------------------------------- 

----------------------------------------------------------------------------------------------------
Created output dir /home/xzcaplas/PHAS0097_RLASSEN/salt/submit/output/supervising/base/gn2v01_phase2_FULL_GNCLUS_v2_b2000_e40_20240312-T104149
---------------------------------------------------------------------------------------------------- 

COMET INFO: Experiment is live on comet.com https://www.comet.com/xzcaplas/salt/030c7c0e6bc74241b23292d7de8b56c6

LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2]
Loading `train_dataloader` to estimate number of stepping batches.

  | Name            | Type                   | Params
-----------------------------------------------------------
0 | model           | SaltModel              | 2.4 M 
1 | model.init_nets | ModuleList             | 142 K 
2 | model.tasks     | ModuleList             | 130 K 
3 | model.encoder   | TransformerEncoder     | 2.1 M 
4 | model.pool_net  | GlobalAttentionPooling | 129   
5 | norm            | InputNorm              | 0     
-----------------------------------------------------------
2.4 M     Trainable params
0         Non-trainable params
2.4 M     Total params
9.659     Total estimated model params size (MB)
Sanity Checking: 0it [00:00, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:01<00:00,  1.63it/s]                                                                           Training: 0it [00:00, ?it/s]Training:   0%|          | 0/17017 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/17017 [00:00<?, ?it/s] Epoch 0:   0%|          | 50/17017 [00:43<4:05:34,  1.15it/s]Epoch 0:   0%|          | 50/17017 [00:43<4:05:34,  1.15it/s, v_num=56c6]Epoch 0:   1%|          | 100/17017 [00:48<2:18:02,  2.04it/s, v_num=56c6]Epoch 0:   1%|          | 100/17017 [00:48<2:18:02,  2.04it/s, v_num=56c6]Epoch 0:   1%|          | 150/17017 [01:07<2:05:41,  2.24it/s, v_num=56c6]Epoch 0:   1%|          | 150/17017 [01:07<2:05:41,  2.24it/s, v_num=56c6]Epoch 0:   1%|          | 200/17017 [01:12<1:41:47,  2.75it/s, v_num=56c6]Epoch 0:   1%|          | 200/17017 [01:12<1:41:47,  2.75it/s, v_num=56c6]Epoch 0:   1%|▏         | 250/17017 [01:33<1:44:12,  2.68it/s, v_num=56c6]Epoch 0:   1%|▏         | 250/17017 [01:33<1:44:12,  2.68it/s, v_num=56c6]Epoch 0:   2%|▏         | 300/17017 [01:40<1:33:10,  2.99it/s, v_num=56c6]Epoch 0:   2%|▏         | 300/17017 [01:40<1:33:10,  2.99it/s, v_num=56c6]Epoch 0:   2%|▏         | 350/17017 [01:45<1:24:03,  3.30it/s, v_num=56c6]Epoch 0:   2%|▏         | 350/17017 [01:45<1:24:03,  3.30it/s, v_num=56c6]Epoch 0:   2%|▏         | 400/17017 [01:58<1:21:56,  3.38it/s, v_num=56c6]Epoch 0:   2%|▏         | 400/17017 [01:58<1:21:56,  3.38it/s, v_num=56c6]Epoch 0:   3%|▎         | 450/17017 [02:03<1:15:57,  3.64it/s, v_num=56c6]Epoch 0:   3%|▎         | 450/17017 [02:03<1:15:57,  3.64it/s, v_num=56c6]Epoch 0:   3%|▎         | 500/17017 [02:14<1:14:15,  3.71it/s, v_num=56c6]Epoch 0:   3%|▎         | 500/17017 [02:14<1:14:15,  3.71it/s, v_num=56c6]Epoch 0:   3%|▎         | 550/17017 [02:23<1:11:41,  3.83it/s, v_num=56c6]Epoch 0:   3%|▎         | 550/17017 [02:23<1:11:41,  3.83it/s, v_num=56c6]Epoch 0:   4%|▎         | 600/17017 [02:29<1:07:59,  4.02it/s, v_num=56c6]Epoch 0:   4%|▎         | 600/17017 [02:29<1:07:59,  4.02it/s, v_num=56c6]Epoch 0:   4%|▍         | 650/17017 [02:42<1:08:22,  3.99it/s, v_num=56c6]Epoch 0:   4%|▍         | 650/17017 [02:42<1:08:22,  3.99it/s, v_num=56c6]Epoch 0:   4%|▍         | 700/17017 [02:48<1:05:24,  4.16it/s, v_num=56c6]Epoch 0:   4%|▍         | 700/17017 [02:48<1:05:24,  4.16it/s, v_num=56c6]Epoch 0:   4%|▍         | 750/17017 [03:01<1:05:28,  4.14it/s, v_num=56c6]Epoch 0:   4%|▍         | 750/17017 [03:01<1:05:28,  4.14it/s, v_num=56c6]Epoch 0:   5%|▍         | 800/17017 [03:06<1:03:04,  4.29it/s, v_num=56c6]Epoch 0:   5%|▍         | 800/17017 [03:06<1:03:04,  4.29it/s, v_num=56c6]Epoch 0:   5%|▍         | 850/17017 [03:12<1:00:56,  4.42it/s, v_num=56c6]Epoch 0:   5%|▍         | 850/17017 [03:12<1:00:56,  4.42it/s, v_num=56c6]Epoch 0:   5%|▌         | 900/17017 [03:17<59:01,  4.55it/s, v_num=56c6]  Epoch 0:   5%|▌         | 900/17017 [03:17<59:01,  4.55it/s, v_num=56c6]Epoch 0:   6%|▌         | 950/17017 [03:23<57:17,  4.67it/s, v_num=56c6]Epoch 0:   6%|▌         | 950/17017 [03:23<57:17,  4.67it/s, v_num=56c6]Epoch 0:   6%|▌         | 1000/17017 [03:30<56:18,  4.74it/s, v_num=56c6]Epoch 0:   6%|▌         | 1000/17017 [03:30<56:18,  4.74it/s, v_num=56c6]Epoch 0:   6%|▌         | 1050/17017 [03:36<54:52,  4.85it/s, v_num=56c6]Epoch 0:   6%|▌         | 1050/17017 [03:36<54:52,  4.85it/s, v_num=56c6]slurmstepd: error: *** JOB 17978 ON compute-gpu-0-1 CANCELLED AT 2024-03-12T10:46:08 ***
[rank: 2] Received SIGTERM: 15
[rank: 1] Received SIGTERM: 15
--- Logging error ---
--- Logging error ---
Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1612, in _log
    fn, lno, func, sinfo = self.findCaller(stack_info, stacklevel)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 67661) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 36, in __call__
    signal_handler(signum, frame)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 109, in _sigterm_notifier_fn
    log.info(rank_prefixed_message(f"Received SIGTERM: {signum}", self.trainer.local_rank))
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1477, in info
    self._log(INFO, msg, args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1612, in _log
    fn, lno, func, sinfo = self.findCaller(stack_info, stacklevel)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 66197) is killed by signal: Terminated. 
Call stack:
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/python_install/bin/salt", line 8, in <module>
    sys.exit(main())
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/main.py", line 16, in main
    SaltCLI(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 353, in __init__
    self._run_subcommand(self.subcommand)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 642, in _run_subcommand
    fn(**fn_kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/utils/cli.py", line 74, in fit
    self.trainer.fit(model, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 42, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 92, in launch
    return function(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 978, in _run_stage
    self.fit_loop.run()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 189, in advance
    batch = next(data_fetcher)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/utilities/combined_loader.py", line 64, in __next__
    out[i] = next(self.iterators[i])
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 629, in __next__
    with torch.autograd.profiler.record_function(self._profile_name):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/autograd/profiler.py", line 507, in __exit__
    torch.ops.profiler._record_function_exit._RecordFunction(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/_ops.py", line 287, in __call__
    return self._op(*args, **kwargs or {})
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 36, in __call__
    signal_handler(signum, frame)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 109, in _sigterm_notifier_fn
    log.info(rank_prefixed_message(f"Received SIGTERM: {signum}", self.trainer.local_rank))
Message: '[rank: 1] Received SIGTERM: 15'
Arguments: ()
Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
RuntimeError: reentrant call inside <_io.BufferedWriter name='<stderr>'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1103, in emit
    stream.write(msg + self.terminator)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 36, in __call__
    signal_handler(signum, frame)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 109, in _sigterm_notifier_fn
    log.info(rank_prefixed_message(f"Received SIGTERM: {signum}", self.trainer.local_rank))
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1477, in info
    self._log(INFO, msg, args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1624, in _log
    self.handle(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1634, in handle
    self.callHandlers(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1696, in callHandlers
    hdlr.handle(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 968, in handle
    self.emit(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1108, in emit
    self.handleError(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1021, in handleError
    sys.stderr.write('--- Logging error ---\n')
RuntimeError: reentrant call inside <_io.BufferedWriter name='<stderr>'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1021, in handleError
    sys.stderr.write('--- Logging error ---\n')
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 67623) is killed by signal: Terminated. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/python_install/bin/salt", line 8, in <module>
    sys.exit(main())
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/main.py", line 16, in main
    SaltCLI(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 353, in __init__
    self._run_subcommand(self.subcommand)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/cli.py", line 642, in _run_subcommand
    fn(**fn_kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/utils/cli.py", line 74, in fit
    self.trainer.fit(model, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 42, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 92, in launch
    return function(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/trainer.py", line 978, in _run_stage
    self.fit_loop.run()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/training_epoch_loop.py", line 218, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/optimization/automatic.py", line 185, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/optimization/automatic.py", line 261, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 142, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/core/module.py", line 1265, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/core/optimizer.py", line 158, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 259, in optimizer_step
    optimizer_output = super().optimizer_step(optimizer, closure, model, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/strategies/strategy.py", line 224, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/plugins/precision/amp.py", line 70, in optimizer_step
    closure_result = closure()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/optimization/automatic.py", line 140, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/optimization/automatic.py", line 126, in closure
    step_output = self._step_fn()
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/loops/optimization/automatic.py", line 308, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/strategies/ddp.py", line 331, in training_step
    return self.model(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/overrides/base.py", line 90, in forward
    output = self._forward_module.training_step(*inputs, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/modelwrapper.py", line 123, in training_step
    preds, labels, _, loss = self.shared_step(batch)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/modelwrapper.py", line 104, in shared_step
    preds, loss = self(inputs, mask, labels)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/modelwrapper.py", line 78, in forward
    return self.model(x, mask, labels)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/models/saltmodel.py", line 67, in forward
    combined_embeddings = self.encoder(initial_embeddings, mask=mask, edge_x=edge_x)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/models/transformer.py", line 198, in forward
    x = layer(x, mask=mask, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/salt/models/transformer.py", line 99, in forward
    self.norm1(x),
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 190, in forward
    return F.layer_norm(
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/nn/functional.py", line 2515, in layer_norm
    return torch.layer_norm(input, normalized_shape, weight, bias, eps, torch.backends.cudnn.enabled)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 36, in __call__
    signal_handler(signum, frame)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/signal_connector.py", line 109, in _sigterm_notifier_fn
    log.info(rank_prefixed_message(f"Received SIGTERM: {signum}", self.trainer.local_rank))
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1477, in info
    self._log(INFO, msg, args, **kwargs)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1624, in _log
    self.handle(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1634, in handle
    self.callHandlers(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1696, in callHandlers
    hdlr.handle(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 968, in handle
    self.emit(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1108, in emit
    self.handleError(record)
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/logging/__init__.py", line 1021, in handleError
    sys.stderr.write('--- Logging error ---\n')
  File "/home/xzcaplas/PHAS0097_RLASSEN/salt/conda/envs/salt/lib/python3.10/site-packages/torch/utils/data/_utils/signal_handling.py", line 66, in handler
    _error_if_any_worker_fails()
RuntimeError: DataLoader worker (pid 66135) is killed by signal: Terminated. 
